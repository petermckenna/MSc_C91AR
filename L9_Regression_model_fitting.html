<!DOCTYPE html>
<html lang="en"><head>
<script src="L9_Regression_model_fitting_files/libs/clipboard/clipboard.min.js"></script>
<script src="L9_Regression_model_fitting_files/libs/quarto-html/tabby.min.js"></script>
<script src="L9_Regression_model_fitting_files/libs/quarto-html/popper.min.js"></script>
<script src="L9_Regression_model_fitting_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="L9_Regression_model_fitting_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="L9_Regression_model_fitting_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="L9_Regression_model_fitting_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="L9_Regression_model_fitting_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <meta name="author" content="Dr Pete McKenna">
  <meta name="dcterms.date" content="2025-03-21">
  <title>Lecture 9: Model fitting</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="L9_Regression_model_fitting_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="L9_Regression_model_fitting_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="L9_Regression_model_fitting_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="peter_style.css">
  <link href="L9_Regression_model_fitting_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="L9_Regression_model_fitting_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="L9_Regression_model_fitting_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="L9_Regression_model_fitting_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="images/anime_programming.jpg" data-background-position="50% 8%" data-background-size="20%" class="quarto-title-block center">
  <h1 class="title">Lecture 9: Model fitting</h1>
  <p class="subtitle">C91AR: Advanced Statistics using R</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr Pete McKenna 
</div>
</div>
</div>

  <p class="date">2025-03-21</p>
</section>
<section id="session-outline" class="title-slide slide level1 center">
<h1>Session outline</h1>
<ul>
<li>Today, we are going to examine methods for checking how well a model fits the data</li>
<li>There are a variety of fitting methods worth becoming familiar with</li>
<li>We are going to look at a few today outlined in <span class="citation" data-cites="Canduela_Raeside_2020">Canduela and Raeside (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span></li>
<li>On Thursday I will run a code clinic where you can ask me any questions about R, to give you some extra support as your prepare the summative assessment.</li>
</ul>
<!--

# Regression Theory

-   Regression can be thought of as a process of generating a line of
    best fit given the data.
-   Rather than draw by hand, a procedure called **least squares
    regression** can be used to reliably draw this line.

## Least squares regression

The line is adjusted to minimise the SSE (sum of squared deviations; $e_{i}^{2}$) of each point from the line:

Minimise SSE =
$min \underset{i=1}{\stackrel{n}{\sum}}e_{i}^{2} = min \underset{i=1}{\stackrel{n}{\sum}}(y_{i} - \hat{y}_{i})^2$

-   $y_{i}$ = observed value
-   $\hat{y}_{i}$ = predicted value
-   $e_{i}$ = error
-   $n$ = number of observations
-   $\underset{i=1}{\stackrel{n}{\sum}}$ = summation of a sequence of terms indexed by $i$, starting from $i = 1$ and ending at $i = n$


# Illustration of regression

#![](images/RM3_regression.png){left="0" width="580" height="590"}

- So, least squares regression is summation of all of the squared differences ($e_{i}$) between the observed ($y_{i}$) and predicted ($\hat{y}_{i}$) values of $y$


# Regression formula

$$Y_i = \beta_0 + \beta_1 X_i + e_i$$

Where...

-   $y_{i}$ = $i$th observation of the dependent variable,
    $i = 1,2,...,n$
-   $x_{i}$ = $i$th observation for the independent variable,
    $i = 1,2,...n$
-   $\beta_{0}$ = intercept or constant
-   $\beta_{1}$ = the slope or gradient of the predictor/independent
    variable
-   $\epsilon_{i}$ = error or residual of the $i$th observation
-   $n$ = total number of observations

<!--
# Calculating coefficients

$\beta_{0}$ and $\beta_{1}$ are **coefficients** and can be estimated
using the following equations:

$\hat{\beta}_{1} = \frac{\underset{i=1}{\stackrel{n}{\sum}}(x_{i} - \overline{x})(y_{i} - \overline{y})}{\underset{i=1}{\stackrel{n}{\sum}}(x_{i} - \overline{x})^2}$

$\beta_{0} = \overline{y} - \hat{\beta}_{1}\overline{x}$    


# The relationship between correlation and regression?

-   Correlation tells us about the strength and relationship between two
    variables.
-   Regression (on the other hand) predicts the value of one variable
    based on the value of another variable.
-   For example, in the heights and weights data, we can use regression
    modelling to *predict someone's weight given their height*.

-->
</section>

<section id="reproducibility-notation" class="title-slide slide level1 center">
<h1>Reproducibility &amp; notation</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Change the output format</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

<section id="load-packages" class="title-slide slide level1 center">
<h1>Load packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Load packages</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse,</span>
<span id="cb2-3"><a href="#cb2-3"></a>               corrr,</span>
<span id="cb2-4"><a href="#cb2-4"></a>               tidyplots,</span>
<span id="cb2-5"><a href="#cb2-5"></a>               car) <span class="co"># for VIF</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

<section id="data-setup" class="title-slide slide level1 center">
<h1>Data setup</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Read in the data</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>handw <span class="ot">&lt;-</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">read_csv</span>(<span class="st">"data_raw/heights_and_weights.csv"</span>,</span>
<span id="cb3-4"><a href="#cb3-4"></a>           <span class="at">col_types =</span> <span class="st">"dd"</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co"># Add log transformed vectors to dataset</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>handw_log <span class="ot">&lt;-</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>  handw <span class="sc">|&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="fu">mutate</span>(<span class="at">hlog =</span> <span class="fu">log</span>(height_in),  </span>
<span id="cb3-11"><a href="#cb3-11"></a>         <span class="at">wlog =</span> <span class="fu">log</span>(weight_lbs))</span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co"># load grades data for VIF</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>grades <span class="ot">&lt;-</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>  <span class="fu">read_csv</span>(<span class="st">"data_tidy/grades.csv"</span>,</span>
<span id="cb3-16"><a href="#cb3-16"></a>           <span class="at">col_types =</span> <span class="st">"ddii"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<!--

# Remind me, why are we using the log of the data?

# Raw data





# Normalised data






# Rationale for taking the log

-   When we take the log of the data we normalise it, to stabilise the
    variance in our vectors.
-   This is particularly useful if the data are highly skewed or show
    **heteroscedasticity**
    -   When the difference between the observed and predicted values
        (i.e., the residuals $e_i$) is not constant across all levels of
        the independent variables.
    -   For the heights and weights data, you can see that the residuals increase as the values for height and weight approach the upper limit 
-   Normalised data is more suitable for statistical analysis that
    assume normality, such as linear regression.


# Using regression to make predictions based on height and weight data

**Regression formula**

$$Y_i = \beta_0 + \beta_1 X_i + e_i$$

**In the context of predicting height from weight**

-   $Y_i$ = prediction of a person $i$'s weight

-   $X_i$ = observed height

-   $\beta_0$ = y-intercept

-   $\beta_1$ = slope parameter

-   $e_i$ = residuals

    -   Note, it is assumed that $e_i$ comes from a normal distribution
        with a mean of zero and variance $\sigma^2$.
        
<!--

# Making predictions using the available statistics

To estimate the parameters of the regression between the y-intercept
($\beta_0$) and the slope ($\beta_1$) all we need is the:

-   Mean estimates for $X$ and $Y$, denoted as $\hat{\mu_x}$ & $\hat{\mu_y}$
-   Standard deviations for $X$ and $Y$, denoted as $\hat{\sigma_x}$ &
    $\hat{\sigma_y}$
-   Correlations between $X$ and $Y$, denoted as $\hat{\rho}$
-   Note: the $\hat{hat}$ denotes an estimate of a population parameter.

So, the statistics required to estimate $\beta_0$ and $\beta_1$ are much
the same as we used for simulating correlational data.

# A reminder of our previous calculations

-   $\hat{\mu_x} = 4.11, \hat{\sigma_x} = 0.26$ (estimated mean and SD
    of log height)

-   $\hat{\mu_y} = 4.74, \hat{\sigma_y} = 0.65$ (estimated mean and SD
    of log weight)

-   $\hat{\rho_{xy}} = 0.96$ (estimated correlation between the two)

# Estimating the slope $\beta_1$

-   Let's start by estimating the value of the slope $\beta_1$.
-   Importantly, $\beta_1$ can be expressed in terms of the correlation
    coefficient $\rho$ times the ratio of the standard deviations of $Y$
    and $X$.

$$\beta_1 = \rho\frac{ \sigma_Y}{\sigma_X}$$

# Plugging in the numbers

-   Now, you can use the estimates of log height and log weight, to
    estimate the slope:

$$\beta_1 = \rho\frac{ \sigma_Y}{\sigma_X}$$

In R Code:


::: {.cell}

```{.r .cell-code}
# Estimate slope using formula
b1 <- .96 * (.65 / .26)
b1 # 2.4
```

::: {.cell-output .cell-output-stdout}
```
[1] 2.4
```
:::
:::


# Using the Axis to fill in the blanks: part 1

-   For mathematical reasons, the regression line is **guaranteed to go
    through the point corresponding to the mean of both $X$ and $Y$,
    i.e., the point ($\mu_x$, $\mu_y$)**.

-   One way to think about this is that the regression line pivots
    around that point depending on the slope ($\beta_1$).

-   We also know that $\beta_0$ is the y-intercept, where the line
    crosses the vertical axis at $X$ = 0.
    
    
# Regression line passing through variable means ($\mu_x$, $\mu_y$)
    




<!--

This code will generate a plot with:
- A scatter plot of the log-transformed data points in blue.
- A red regression line.
- Green dashed lines representing the means of log-transformed height and weight.
- A purple point at the intersection of the means of log-transformed height and weight, labeled "Mean (hlog, wlog)".

Feel free to run this code in your R environment and let me know if you need any further assistance!


This code will generate a plot with:
- A scatter plot of the data points in blue.
- A red regression line.
- Green dashed lines representing the means of X and Y.
- A purple point at the intersection of the means of X and Y, labeled "Mean (X, Y)".

Feel free to run this code in your R environment and let me know if you need any further assistance!




# Using the Axis to fill in the blanks: part 2

-   From all of this information we can calculate $\beta_0$.

-   Remember that $\beta_1$ tells you that for each change in $X$ you
    have a corresponding change of **2.4** for $Y$, and that the line
    goes through points ($\mu_x$, $\mu_y$) as well as the y-intercept
    (0, $\beta_0$).

# Re-framing the calculations

-   Think about stepping back unit-by-unit from the mean of $X = \mu_x$
    to $X = 0$.

-   At $X =\mu_x$, $Y = 4.74$, because as stated earlier, the regression
    line is guaranteed to go through the point corresponding to the mean
    of both $X$ and $Y$, i.e., the point ($\mu_x$, $\mu_y$) or (4.11,
    4.74).

-   Each unit step you take backward in the $X$ dimension, $Y$ will
    reduce by $\beta_1 = 2.4$ units.

-   When you get to zero, $Y$ will have dropped from $\mu_y$ to
    $\mu_y - \mu_x\beta_1$.
    
    
# Illustrating this relationship    

#![](images/regression_equation.png)





    

# The Solution

-   With all of the above considerations taking into account the
    solution is $\beta_0 = \mu_y - \mu_x\beta_1$.

-   Using this information we can calculate the slope value:
    $\beta_0 = 4.74 - 4.11 \times 2.4 = -5.124$

-   Now we have the following statistics:

    -   $\beta_1 = 2.4$

    -   $\mu_x = 4.11$

    -   $\mu_y - 4.74$

    -   $\beta_0 = -5.124$
    

# Plugging in the numbers

So..

$$Y_i = \beta_0 + \beta_1 X_i + e_i$$
Becomes...  

$$Y_i = -5.124 + 2.4X_i + e_i$$

# Checking the results

-   To check the results, let's first run a regression on the log
    transformed data using `lm()`, which estimates parameters using
    *ordinary least squares (OLS) regression*.
-   In OLS regression, the goal is to find the line that best fits the
    data by minimizing the sum of the squared differences between the
    observed values of the dependent variable and the values predicted
    by the regression line.
-   Note, you are interested in the `Estimate` values.


::: {.cell output-location='slide'}

```{.r .cell-code}
summary(lm(wlog ~ hlog,
           data = handw_log))
```

::: {.cell-output .cell-output-stdout}
```

Call:
lm(formula = wlog ~ hlog, data = handw_log)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.63296 -0.09915 -0.01366  0.09285  0.65635 

Coefficients:
            Estimate Std. Error t value            Pr(>|t|)    
(Intercept) -5.26977    0.13169  -40.02 <0.0000000000000002 ***
hlog         2.43304    0.03194   76.17 <0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1774 on 473 degrees of freedom
Multiple R-squared:  0.9246,    Adjusted R-squared:  0.9245 
F-statistic:  5802 on 1 and 473 DF,  p-value: < 0.00000000000000022
```
:::
:::


# Matching the regression output to our calculations

From the model output:

-   Estimated slope parameter $\beta_1 = 2.433$ (2.4 from our
    calculations)

-   Estimated y-intercept $\beta_0 = -5.269$ (-5.124 from our
    calculations)

-   These don't match exactly because of the rounding we've used in our
    calculations.

# Checking your regression estimate with a plot

Another way to check the accuracy of your regression calculations is to
superimpose the regression line on the scatter-plot of the log
transformed data.





# Predicting someone's weight given their height

-   Say we want to predict the weight of someone who is 69inches or
    175cm (average height of a person from the US). Let's plug the log
    of this value (4.23) into our regression formula:

$Y_i = -5.124 + 2.4 \times 4.23 + e_i$

-   Note: We do not need to provide the residuals ($e_i$) as they are
    estimated from the regression equation.

$Y_i = 5.028$

$exp(5.028) = 152.63lbs = 69.2kg$

-   So, our regression model predicts that someone who is 175cm tall
    would weigh 69.2kg.

# A little more about $e_i$

-   Conventionally, $e_i$ come from a normal distribution with $\mu = 0$
    and variance $\sigma^2$.
-   $e_i$ are important for assessing the model's performance and
    diagnostic purposes but they are not necessary for making
    predictions using the regression equation.
    
# Model fit

- We did not cover how to test the model's fit today
- This is covered in the RM3 textbook, and there are good resources elsewhere
- I prioritised familiarity with the modelling process over assumption checking
    
# Roundup

- Today I have shown you how to calculate a simple regression model by hand using formula
- The aim was to unveil some of the computation that goes on behind the scene to help you understand what regression analysis is actually doing. 
- Using this method, we also made a prediction about someone's height given their weight. 
- On Monday, we are going to look at multiple regression

-->
</section>

<section id="r2-coefficient-of-determination" class="title-slide slide level1 center">
<h1><span class="math inline">\(R^{2}\)</span> Coefficient of determination</h1>
<ul>
<li><p>To this point we have created a regression equation and used it to predict someone’s weight given their height.</p></li>
<li><p>But, we also want to know how good a fit our equation is given the data. To calculate this we use the <strong><em>coefficient of determination</em></strong> (<span class="math inline">\(R^2\)</span>):</p></li>
</ul>
<p><span class="math inline">\(R^2 = \frac{\text{Sum of Squares Explained by Regression (SSR)}}{\text{Total Sum of Squares (before regression)(TSS)}} = \frac{\underset{i=1}{\stackrel{n}{\sum}}(\hat{y}_{i} - \overline{y})^2}{\underset{i=1}{\stackrel{n}{\sum}}(y_{i} - \overline{y})^{2}}\)</span></p>
</section>

<section id="calculating-the-total-sum-of-squares" class="title-slide slide level1 center">
<h1>Calculating the total sum of squares</h1>
<ul>
<li>The total sum of squares (TSS) in the dependent variable (i.e., weight) is split into two parts:
<ul>
<li>the part explained by sum of squares explain by regression (SSR), which is the sum of the squared differences between the predicted values (<span class="math inline">\(\hat{y}_{i}\)</span>) and the mean of the response variable (<span class="math inline">\(\overline{y}\)</span>)</li>
</ul></li>
</ul>
<p><span class="math display">\[\text{Sum of Squares Explained by Regression (SSR)} = \sum_{i=1}^{n} (\hat{y}_{i} - \overline{y})^2\]</span></p>
<ul>
<li>the part that is unexplained sum of squared errors (SSE), which is the squared difference between the observed values (<span class="math inline">\(y_{i}\)</span>) and the predicted values (<span class="math inline">\(\hat{y}_{i}\)</span>), since the relationship is never perfect and there are always some residuals.</li>
</ul>
<p><span class="math display">\[\text{Sum of Squares Errors (SSE)} = \sum_{i=1}^{n} (y_{i} - \overline{y})^2\]</span></p>
</section>

<section id="illustration-of-the-error-in-regression" class="title-slide slide level1 center">
<h1>Illustration of the error in regression</h1>
<p><img data-src="images/regression_terminologies.png" data-left="0" width="580" height="590"></p>
</section>

<section id="r2-thresholds" class="title-slide slide level1 center">
<h1><span class="math inline">\(R^{2}\)</span> Thresholds</h1>
<ul>
<li>The coefficient of determination can take values between 0 and 1, but is commonly reported as a percentage, as it represent the proportion of the variation in the dependent variable (<span class="math inline">\(Y_{i}\)</span>) which is explained by the predictor/independent variable (<span class="math inline">\(X_{i}\)</span>).</li>
<li>The higher the <span class="math inline">\(R^{2}\)</span> value (at least <span class="math inline">\(70\%\)</span>) the better the model fit.</li>
<li>A reasonable model fit would be more <span class="math inline">\(R^{2} &gt;= 60\%\)</span>.</li>
</ul>
</section>

<section id="exploring-the-errors" class="title-slide slide level1 center">
<h1>Exploring the Errors</h1>
<ul>
<li><p>To assess the quality of the model further we need to look at the <em>errors</em> or <em>residuals</em> <span class="math inline">\((y_{i} - \hat{y}_{i})\)</span> after running the regression model.</p></li>
<li><p>Model residuals should be <strong>randomly scattered</strong> with <strong>no extreme values</strong> and should have a <strong>mean of zero</strong>.</p></li>
<li><p>Should these requirements not be met we would have to further investigate whether there is information in the residuals that could be covered by the model or be considered a cause for concern.</p></li>
<li><p>A histogram of the residuals and normal probability plot can help you decide how well your residuals fit into the model.</p></li>
</ul>
</section>

<section id="histogram-of-model-residuals" class="title-slide slide level1 center">
<h1>Histogram of model residuals</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Create model for raw data</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>mod1 <span class="ot">&lt;-</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">lm</span>(weight_lbs <span class="sc">~</span> height_in,</span>
<span id="cb4-4"><a href="#cb4-4"></a>     <span class="at">data =</span> handw)</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># Create residuals object</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>residuals_df <span class="ot">&lt;-</span> </span>
<span id="cb4-8"><a href="#cb4-8"></a>  mod1<span class="sc">$</span>residuals <span class="sc">|&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="fu">rename</span>(<span class="at">residuals =</span> value)</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co"># Plot the data</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="fu">ggplot</span>(residuals_df, <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Residuals"</span>,</span>
<span id="cb4-16"><a href="#cb4-16"></a>       <span class="at">x =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb4-17"><a href="#cb4-17"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<p>Are the residuals <strong>randomly scattered</strong> with <strong>no extreme values</strong>?</p>
</section>

<section id="histogram-of-model-residuals-output" class="title-slide slide level1 output-location-slide center"><h1>Histogram of model residuals</h1><div class="cell output-location-slide">
<div class="cell-output-display">
<p><img data-src="L9_Regression_model_fitting_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></p>
</div>
</div></section><section id="transformed-data-residuals-plot" class="title-slide slide level1 center">
<h1>Transformed data: residuals plot</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Create model for transformed data</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>mod2 <span class="ot">&lt;-</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">lm</span>(wlog <span class="sc">~</span> hlog,</span>
<span id="cb5-4"><a href="#cb5-4"></a>     <span class="at">data =</span> handw_log)</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># Create residuals object</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>residuals_df <span class="ot">&lt;-</span> </span>
<span id="cb5-8"><a href="#cb5-8"></a>  mod2<span class="sc">$</span>residuals <span class="sc">|&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="fu">rename</span>(<span class="at">residuals =</span> value)</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co"># Plot the data</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="fu">ggplot</span>(residuals_df, <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Log Transformed Residuals"</span>,</span>
<span id="cb5-16"><a href="#cb5-16"></a>       <span class="at">x =</span> <span class="st">"Log(residuals)"</span>,</span>
<span id="cb5-17"><a href="#cb5-17"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<p>Are the residuals <strong>randomly scattered</strong> with <strong>no extreme values</strong>?</p>
</section>

<section id="transformed-data-residuals-plot-output" class="title-slide slide level1 output-location-slide center"><h1>Transformed data: residuals plot</h1><div class="cell output-location-slide">
<div class="cell-output-display">
<p><img data-src="L9_Regression_model_fitting_files/figure-revealjs/unnamed-chunk-11-1.png" width="960"></p>
</div>
</div></section><section id="quantile-quantile-q-q-plot" class="title-slide slide level1 center">
<h1>Quantile quantile (Q-Q) plot</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>A Q-Q plot compares the quantiles of the observed data to the quantiles of a theoretical distribution.</li>
<li>It plots the observed quantiles on the y-axis and the theoretical quantiles on the x-axis.</li>
<li>The primary purpose of a Q-Q plot is to visually assess how well the observed data fits a specified theoretical distribution.</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>It helps identify deviations from the theoretical distribution, such as skewness, kurtosis, or other anomalies.</li>
<li>In regression analysis and other statistical modeling, Q-Q plots are used to check the normality of residuals, which is an assumption for many statistical tests and models.</li>
</ul>
</div>
</div>
</section>

<section>
<section id="interpreting-a-q-q-plot" class="title-slide slide level1 center">
<h1>Interpreting a Q-Q plot</h1>
<ul>
<li>If the data points lie approximately along a straight diagonal (45°) line, it suggests that the data follows the theoretical distribution.</li>
<li>Deviations from the diagonal line indicate departures from the theoretical distribution. For example, a systematic curve might indicate skewness, while points that diverge at the ends might indicate heavy tails.</li>
</ul>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Extract residuals</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>residuals <span class="ot">&lt;-</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  mod1<span class="sc">$</span>residuals</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># Calculate theoretical quantiles</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>mod1_quantiles <span class="ot">&lt;-</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">qqnorm</span>(residuals, <span class="at">plot.it =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>x</span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co"># Create a data frame with residuals and theoretical quantiles</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>pp_df <span class="ot">&lt;-</span> </span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="at">residuals =</span> residuals,</span>
<span id="cb6-13"><a href="#cb6-13"></a>  <span class="at">theoretical_quantiles =</span> mod1_quantiles</span>
<span id="cb6-14"><a href="#cb6-14"></a>)</span>
<span id="cb6-15"><a href="#cb6-15"></a></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co"># Plot the P-P plot</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="fu">ggplot</span>(pp_df, <span class="fu">aes</span>(<span class="at">sample =</span> residuals)) <span class="sc">+</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal P-P Plot of Residuals"</span>,</span>
<span id="cb6-21"><a href="#cb6-21"></a>       <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>,</span>
<span id="cb6-22"><a href="#cb6-22"></a>       <span class="at">y =</span> <span class="st">"Sample Quantiles"</span>) <span class="sc">+</span></span>
<span id="cb6-23"><a href="#cb6-23"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section><section id="" class="slide level2 output-location-slide"><div class="cell output-location-slide">
<div class="cell-output-display">
<p><img data-src="L9_Regression_model_fitting_files/figure-revealjs/unnamed-chunk-12-1.png" width="960"></p>
</div>
</div></section></section>
<section id="transformed-data-normal-pp-plot" class="title-slide slide level1 center">
<h1>Transformed data: Normal PP plot</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Extract residuals</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>residuals <span class="ot">&lt;-</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  mod2<span class="sc">$</span>residuals</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co"># Calculate theoretical quantiles</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>mod2_quantiles <span class="ot">&lt;-</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="fu">qqnorm</span>(residuals, <span class="at">plot.it =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>x</span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co"># Create a data frame with residuals and theoretical quantiles</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>pp_df <span class="ot">&lt;-</span> </span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb7-12"><a href="#cb7-12"></a>  <span class="at">residuals =</span> residuals,</span>
<span id="cb7-13"><a href="#cb7-13"></a>  <span class="at">theoretical_quantiles =</span> mod2_quantiles</span>
<span id="cb7-14"><a href="#cb7-14"></a>)</span>
<span id="cb7-15"><a href="#cb7-15"></a></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co"># Plot the P-P plot</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="fu">ggplot</span>(pp_df, <span class="fu">aes</span>(<span class="at">sample =</span> residuals)) <span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal P-P Plot of log(Residuals)"</span>,</span>
<span id="cb7-21"><a href="#cb7-21"></a>       <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>,</span>
<span id="cb7-22"><a href="#cb7-22"></a>       <span class="at">y =</span> <span class="st">"Sample Quantiles"</span>) <span class="sc">+</span></span>
<span id="cb7-23"><a href="#cb7-23"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>

<section id="transformed-data-normal-pp-plot-output" class="title-slide slide level1 output-location-slide center"><h1>Transformed data: Normal PP plot</h1><div class="cell output-location-slide">
<div class="cell-output-display">
<p><img data-src="L9_Regression_model_fitting_files/figure-revealjs/unnamed-chunk-13-1.png" width="960"></p>
</div>
</div></section><section id="testing-the-significance-of-the-model-and-its-coefficients" class="title-slide slide level1 center">
<h1>Testing the Significance of the model and its coefficients</h1>
<ul>
<li><p>We can use statistical tests to determine how well we are approximating the population parameters with those in our model. To do this we can use two methods:</p></li>
<li><p>Analysis of variance (ANOVA): tests overall significance of the model</p></li>
<li><p><span class="math inline">\(t\)</span>-test: test the individual significance of the coefficients.</p></li>
</ul>
</section>

<section id="testing-the-overall-significance-of-the-model" class="title-slide slide level1 center">
<h1>Testing the overall significance of the model</h1>
<ul>
<li>Testing the overall significance of the model evaluates how well the independent variables reliable predict the dependent variable.</li>
<li>We can create hypotheses to make our statistical inferences:</li>
</ul>
<p><span class="math inline">\(H_{0}\)</span>: The regression model does not explain a significant proportion of the variance in weight (our DV).</p>
<p>VS</p>
<p><span class="math inline">\(H_{1}\)</span>: The regression model does explain a significant proportion of the variation in weight.</p>
<p>And we test the above using the <span class="math inline">\(F\)</span>-distribution.</p>
</section>

<section>
<section id="anova-for-regression-modelling" class="title-slide slide level1 center">
<h1>ANOVA for regression modelling</h1>
<p><strong>ANOVA for regression</strong></p>
<table>
<colgroup>
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 21%">
<col style="width: 15%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Source of Variation</th>
<th>Sum of Squares (SS)</th>
<th>Degrees of Freedom (df)</th>
<th>Mean Square (MS)</th>
<th>F-Statistic (F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Model</td>
<td><span class="math inline">\(\text{SS}_{\text{model}} = \underset{i=1}{\stackrel{n}{\sum}}(\hat{y}_i - \bar{y})^2\)</span></td>
<td>( k )</td>
<td><span class="math inline">\(\text{MSR} = \frac{\text{SSR}}{k}\)</span></td>
<td><span class="math inline">\(\frac{\text{MSR}}{\text{MSE}}\)</span></td>
</tr>
<tr class="even">
<td>Residual</td>
<td><span class="math inline">\(\text{SS}_{\text{residual}} = \underset{i=1}{\stackrel{n}{\sum}}(y_i - \hat{y}_i)^2\)</span></td>
<td>( n - k - 1 )</td>
<td><span class="math inline">\(\text{MSE} = \frac{\text{SSE}}{n - k - 1}\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(\text{TSS} = SSR + SSE = \underset{i=1}{\stackrel{n}{\sum}}(y_i - \bar{y})^2\)</span></td>
<td>( n - 1 )</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section class="slide level2">

<p>ANOVA for regression: key</p>
<ul>
<li><span class="math inline">\(n\)</span> = total number of observations</li>
<li><span class="math inline">\(k\)</span> = total number of independent variables</li>
<li><span class="math inline">\(y\)</span> = the observed values</li>
<li><span class="math inline">\(\overline{y}\)</span> = mean of the dependent variables</li>
<li><span class="math inline">\(\hat{y}_{i}\)</span> = the estimated values</li>
</ul>
</section></section>
<section>
<section id="anova-for-log-transformed-model" class="title-slide slide level1 center">
<h1>ANOVA for log transformed model</h1>
<p>Remember: <code>mod2 &lt;- lm(wlog ~ hlog, data = handw_log)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Run an ANOVA on our log transformed model</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>anova_results <span class="ot">&lt;-</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">anova</span>(mod2)</span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="fu">print</span>(anova_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: wlog
           Df  Sum Sq Mean Sq F value                Pr(&gt;F)    
hlog        1 182.622 182.622  5801.8 &lt; 0.00000000000000022 ***
Residuals 473  14.888   0.031                                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Calculate TSS</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>ss_model <span class="ot">&lt;-</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  anova_results[<span class="st">"hlog"</span>, <span class="st">"Sum Sq"</span>]</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a>ss_residual <span class="ot">&lt;-</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  anova_results[<span class="st">"Residuals"</span>, <span class="st">"Sum Sq"</span>]</span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>tss <span class="ot">&lt;-</span> </span>
<span id="cb10-9"><a href="#cb10-9"></a>  ss_model <span class="sc">+</span> ss_residual</span>
<span id="cb10-10"><a href="#cb10-10"></a></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="fu">print</span>(tss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 197.5102</code></pre>
</div>
</div>
</section></section>
<section id="interpreting-the-results-of-anova" class="title-slide slide level1 center">
<h1>Interpreting the results of ANOVA</h1>
<ul>
<li>We can see from the output that <code>hlog</code> that the slope of the line is significant difference from 0, where <span class="math inline">\(p &lt; 0.001\)</span>.</li>
<li>Thus we reject the null hypothesis (<span class="math inline">\(H_{0}\)</span>).</li>
</ul>
<!--
# Testing individual coefficients

- It is important to determine whether each coefficient is relevant for our model.
- We can do this by checking if it is significantly different from 0.

This can be done by dividing the coefficient by its standard error and comparing the absolute value of that $t$-ratio to the relevant statistic from the $t$-distribution. 

The hypothesis being tested here is as follows:

$H_{0}: \beta_{i}=0$

VS

$H_{a}: \beta_{i}\neq0$
-->
</section>

<section id="multicollinearity" class="title-slide slide level1 center">
<h1>Multicollinearity</h1>
<ul>
<li>Multicollinearity occurs when <strong>two or more predictor variables</strong> in a regression model are highly correlated.</li>
<li>It can cause problems in estimating the coefficients of the regression model, leading to unreliable and unstable estimates.</li>
<li>High multicollinearity inflates the standard errors of the coefficients, making it difficult to determine the individual effect of each predictor.</li>
</ul>
</section>

<section id="variance-inflation-factor-vif" class="title-slide slide level1 center">
<h1>Variance Inflation Factor (VIF)</h1>
<ul>
<li>VIF quantifies the extent of multicollinearity in a regression model.</li>
<li>It measures how much the variance of a regression coefficient is inflated due to multicollinearity.</li>
</ul>
<p><span class="math display">\[\text{VIF}_{j} = \frac{1}{1 - R_{j}^2}\]</span> - <span class="math inline">\(\text{VIF}_{j}\)</span> = the variance inflation factor for variable <em>j</em> - <span class="math inline">\(R_{j}^2\)</span> is the <span class="math inline">\(R^2\)</span> of the regression of variable <em>j</em> over the rest of the variables</p>
</section>

<section id="vif-parameters" class="title-slide slide level1 center">
<h1>VIF parameters</h1>
<ul>
<li>VIF near to 1 indicate no or little correlation between predictor variable j and the other predictors.</li>
<li>VIF values above 4 suggests that multicollinearity may be inflating a coefficient values due to strong predictor correlations</li>
<li>If VIF &gt; 10 then multicollinearity is serious, pointing to unreliable parameter estimates.</li>
</ul>
</section>

<section>
<section id="checking-the-multicollinearity-of-our-grades-regressopn-model" class="title-slide slide level1 center">
<h1>Checking the multicollinearity of our grades regressopn model</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Grades predicted by GPA, lectures attended, and number of VLE downloads </span></span>
<span id="cb12-2"><a href="#cb12-2"></a>model <span class="ot">&lt;-</span> </span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">lm</span>(grade <span class="sc">~</span> GPA <span class="sc">+</span> lecture <span class="sc">+</span> nclicks, grades) </span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># Calculate VIF values</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>vif_values <span class="ot">&lt;-</span> </span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">vif</span>(model)</span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co"># Display VIF values</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="fu">print</span>(vif_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="checking-the-multicollinearity-of-our-grades-regressopn-model-output" class="title-slide slide level1 output-location-slide center"><h1>Checking the multicollinearity of our grades regressopn model</h1><div class="cell output-location-slide">
<div class="cell-output cell-output-stdout">
<pre><code>     GPA  lecture  nclicks 
1.277344 1.337824 1.183668 </code></pre>
</div>
</div></section><section class="slide level2">

<p>What can you infer from the output?</p>
</section></section>
<section id="references" class="title-slide slide level1 smaller scrollable">
<h1>References</h1>

<img src="sossdoc-logo.png" class="slide-logo r-stretch"><div class="footer footer-default">

</div>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Canduela_Raeside_2020" class="csl-entry" role="listitem">
Canduela, Jesus, and Robert Raeside. 2020. <em>The Quantitative Researcher</em>. Heriot-Watt University. <a href="https://www.hw.ac.uk/ebs">www.hw.ac.uk/ebs</a>.
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="L9_Regression_model_fitting_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="L9_Regression_model_fitting_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="L9_Regression_model_fitting_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="L9_Regression_model_fitting_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="L9_Regression_model_fitting_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="L9_Regression_model_fitting_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="L9_Regression_model_fitting_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="L9_Regression_model_fitting_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="L9_Regression_model_fitting_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="L9_Regression_model_fitting_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>